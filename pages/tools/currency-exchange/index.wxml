<view class="container">
  <view class="form-section">
    <text class="title">基本信息：</text>
    <view class="input-group">
      <area id="exchangeSetting" bind:exchange="exchangeChanged" />
    </view>
  </view>

  <!-- 结果展示区域 -->
  <view class="result-section" wx:if="{{resultData}}">
    <!-- 顶部蓝色卡片 -->
    <view class="result-card-blue">
      <view class="result-card-title">{{resultData.titleText}}</view>
      <view class="result-card-amount">{{resultData.formattedExchange}}</view>
      <view class="result-card-sub">
        <view class="result-sub-card">
          <view class="result-sub-label">源货币</view>
          <view class="result-sub-value">{{resultData.fromCurrency}}</view>
        </view>
        <view class="result-sub-card">
          <view class="result-sub-label">目标货币</view>
          <view class="result-sub-value">{{resultData.toCurrency}}</view>
        </view>
      </view>
      <view class="result-disclaimer">
        *汇率数据仅供参考，实际汇率以银行或外汇机构为准。
      </view>
    </view>
  </view>

  <t-loading wx:if="{{loading}}" theme="dots" size="40rpx" text="加载中..." />

  <view class="form-section">
    <text class="title">金额转换：</text>
    <view class="input-group">
      <t-input
        id="amount"
        label="金额"
        placeholder="请输入金额"
        suffix="{{fromCode}}"
        align="right"
        type="number"
        value="{{amount}}"
        bindinput="onAmountInput"
        bindchange="onAmountInput"
        t-class-tips="tips"
      />
    </view>
    <!-- 转换金额显示 -->
    <view class="converted-amount-display" wx:if="{{convertedAmount && resultData && amount}}">
      <view class="converted-amount-label">{{amount}} {{resultData.fromCurrency}} =</view>
      <view class="converted-amount-value">{{convertedAmount}} {{resultData.toCurrency}}</view>
    </view>
    <!-- 默认示例显示 -->
    <view class="converted-amount-display example-display" wx:if="{{!amount && resultData}}">
      <view class="converted-amount-label">示例：1 {{resultData.fromCurrency}} =</view>
      <view class="converted-amount-value">{{resultData.exchangeRate}} {{resultData.toCurrency}}</view>
    </view>
  </view>

  <view class="form-section">
    <text class="title">历史汇率：</text>
    <view class="input-group">
      <view class="date-quick-select">
        <view 
          class="date-quick-item {{dateRangeType === '7d' ? 'active' : ''}}"
          bindtap="onQuickDateSelect"
          data-type="7d"
        >
          最近7天
        </view>
        <view 
          class="date-quick-item {{dateRangeType === '30d' ? 'active' : ''}}"
          bindtap="onQuickDateSelect"
          data-type="30d"
        >
          最近30天
        </view>
        <view 
          class="date-quick-item {{dateRangeType === '90d' ? 'active' : ''}}"
          bindtap="onQuickDateSelect"
          data-type="90d"
        >
          最近90天
        </view>
      </view>
    </view>

    <!-- 汇率趋势图表（F2） -->
    <view class="result-card-white" wx:if="{{chartData && chartData.length > 0}}">
      <view class="result-card-header">
        <text class="result-detail-title">汇率趋势</text>
        <view class="history-info" wx:if="{{selectedHistoryRate}}">
          <text class="history-rate">{{selectedHistoryRate}}</text>
          <text class="history-date">{{selectedHistoryDate}}</text>
        </view>
        <text class="result-detail-sub" wx:elif="{{resultText}}">{{resultText}}</text>
      </view>
      <view class="chart-container">
        <canvas 
          type="2d" 
          id="exchangeChart" 
          class="exchange-chart"
          bindtouchstart="onChartTouchStart"
          bindtouchmove="onChartTouchMove"
          bindtouchend="onChartTouchEnd"
        ></canvas>
      </view>
    </view>
  </view>
</view>
