<view class="container">
  <view class="form-section">
    <text class="title">基本信息：</text>
    <view class="input-group">
      <t-cell 
        title="单位类型" 
        arrow 
        hover 
        note="{{unitTypes[currentUnitType]}}" 
        bind:click="onUnitTypePicker" 
      />
      <t-picker
        visible="{{unitTypeVisible}}"
        value="{{[currentUnitType]}}"
        data-key="unitType"
        title="选择单位类型"
        cancelBtn="取消"
        confirmBtn="确认"
        bindchange="onUnitTypePickerChange"
        bindcancel="onPickerCancel"
      >
        <t-picker-item options="{{unitTypeOptions}}"></t-picker-item>
      </t-picker>
    </view>
  </view>

  <view class="form-section">
    <text class="title">单位选择：</text>
    <view class="input-group">
      <t-cell 
        class="mb-12" 
        title="源单位" 
        arrow 
        hover 
        note="{{currentUnits[fromUnitIndex] ? currentUnits[fromUnitIndex].label : ''}}" 
        bind:click="onFromUnitPicker" 
      />

      <t-picker
        visible="{{fromUnitVisible}}"
        value="{{currentUnits[fromUnitIndex] ? [currentUnits[fromUnitIndex].value] : []}}"
        data-key="fromUnit"
        title="选择源单位"
        cancelBtn="取消"
        confirmBtn="确认"
        bindchange="onFromUnitChange"
        bindcancel="onPickerCancel"
      >
        <t-picker-item options="{{currentUnits}}"></t-picker-item>
      </t-picker>

      <t-cell 
        title="目标单位" 
        arrow 
        hover 
        note="{{currentUnits[toUnitIndex] ? currentUnits[toUnitIndex].label : ''}}" 
        bind:click="onToUnitPicker" 
      />

      <t-picker
        visible="{{toUnitVisible}}"
        value="{{currentUnits[toUnitIndex] ? [currentUnits[toUnitIndex].value] : []}}"
        data-key="toUnit"
        title="选择目标单位"
        cancelBtn="取消"
        confirmBtn="确认"
        bindchange="onToUnitChange"
        bindcancel="onPickerCancel"
      >
        <t-picker-item options="{{currentUnits}}"></t-picker-item>
      </t-picker>
    </view>
  </view>

  <view class="form-section">
    <text class="title">输入数值：</text>
    <view class="input-group">
      <t-input
        id="fromInput"
        label="源值"
        placeholder="请输入数值"
        suffix="{{currentUnits[fromUnitIndex] ? currentUnits[fromUnitIndex].label : ''}}"
        align="right"
        type="digit"
        value="{{fromValue}}"
        bindchange="onInputChange"
        tips="{{inputError ? '请输入有效数字' : ''}}"
        t-class-tips="tips"
      />
    </view>
  </view>

  <group-btn first="重置" second="调换" bind:tap="onTap" />

  <!-- 结果展示区域 -->
  <view class="result-section" wx:if="{{toValue}}">
    <!-- 顶部蓝色卡片 -->
    <view class="result-card-blue">
      <view class="result-card-title">转换结果</view>
      <view class="result-card-amount">{{resultData.formattedResult}}</view>
      <view class="result-card-sub">
        <view class="result-sub-card">
          <view class="result-sub-label">源值</view>
          <view class="result-sub-value">{{resultData.fromValue}}</view>
        </view>
        <view class="result-sub-card">
          <view class="result-sub-label">目标值</view>
          <view class="result-sub-value">{{resultData.toValue}}</view>
        </view>
      </view>
    </view>

    <!-- 底部白色卡片 -->
    <view class="result-card-white">
      <view class="result-card-header">
        <text class="result-detail-title">详细信息</text>
      </view>
      <view class="result-detail-list">
        <view class="result-detail-item">
          <text class="result-detail-label">源单位</text>
          <text class="result-detail-value">{{resultData.fromLabel}}</text>
        </view>
        <view class="result-detail-item">
          <text class="result-detail-label">目标单位</text>
          <text class="result-detail-value">{{resultData.toLabel}}</text>
        </view>
      </view>
    </view>
  </view>
</view>
